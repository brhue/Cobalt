{{!-- Leaving the width of the container for the stylist of the page --}}
{{!-- Needs Styling --}}
{{> header }}
<h1 class="initialButton">Welcome to Cobalt</h1>
<button class="button is-primary initialButton" data-type="create">
    <strong>Create</strong>
</button>
<button class="button is-primary initialButton" data-type="login">
    <strong>Log In</strong>
</button>

<div class="field creatingUser is-hidden">
    <h1>Create a new user account.</h1>
    <label class="label">User Name</label>
    <div class="control">
        <input id="createUserNameInput" class="input" type="text" placeholder="Input User Name Here.">
    </div>
    <p class="help">Between 1 and 50 characters. Alphanumeric only.</p>
</div>

<div class="field is-grouped creatingUser is-hidden">
    <div class="control">
        <button id="createUserSubmit" class="button">Submit</button>
    </div>
    <div class="control">
        <button id="makeLoginForm" class="button">Log In</button>
    </div>
</div>

<div class="field logInUser is-hidden">
    <h1>Login to your account.</h1>
    <label class="label">User Name</label>
    <div class="control">
        <input id="logInUserNameInput" class="input" type="text" placeholder="Input User Name Here.">
    </div>
</div>

<div class="field is-grouped logInUser is-hidden">
    <div class="control">
        <button id="logInUserSubmit" class="button">Submit</button>
    </div>
    <div class="control">
        <button id="makeCreateForm" class="button makeCreateForm">Create User Name</button>
    </div>
</div>

<script type="text/javascript">
    // DOM Variables.
    const initialButton = $(".initialButton");
    const creatingUser = $(".creatingUser");
    const logInUser = $(".logInUser");

    const createUserNameInput = $("#createUserNameInput");
    const logInUserNameInput = $("#logInUserNameInput");
    const createUserSubmit = $("#createUserSubmit");
    const logInUserSubmit = $("#logInUserSubmit");
    const makeLoginForm = $("#makeLoginForm");
    const makeCreateForm = $("#makeCreateForm");
    // Functions.
    function transitionForm(e, input) {
        e.preventDefault();
        if (input === undefined) {
            initialButton.addClass("is-hidden");
            if (this.dataset.type === "create") {
                creatingUser.removeClass("is-hidden");
            } else {
                logInUser.removeClass("is-hidden");
            }
        } else {
            if (input === "login") {
                logInUser.removeClass("is-hidden");
                creatingUser.addClass("is-hidden");
            } else {
                logInUser.addClass("is-hidden");
                creatingUser.removeClass("is-hidden");
            }
        }

    }
    function createUser(e) {
        e.preventDefault();
        const userName = createUserNameInput.val();
        console.log(userName);
        // Do we want to validate here?
        $.post("/api/users", { userName }).then(function (result) {
            location.href = "/users/" + userName;
        }).catch(function (err) {
            // Error catch here.
        })
    }
    // Event Handlers.
    initialButton.on("click", transitionForm)
    makeLoginForm.on("click", (e) => {
        const input = "login";
        transitionForm(e, input);
    })
    makeCreateForm.on("click", (e) => {
        const input = "create";
        transitionForm(e, input);
    })
    createUserSubmit.on("click", createUser)
</script>

